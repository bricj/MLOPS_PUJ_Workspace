[2025-05-01T03:21:43.404+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-05-01T03:21:43.436+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: iniciar_tabla_mysql.start_table manual__2025-05-01T03:16:39.101064+00:00 [queued]>
[2025-05-01T03:21:43.448+0000] {taskinstance.py:2073} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: iniciar_tabla_mysql.start_table manual__2025-05-01T03:16:39.101064+00:00 [queued]>
[2025-05-01T03:21:43.448+0000] {taskinstance.py:2303} INFO - Starting attempt 2 of 2
[2025-05-01T03:21:43.472+0000] {taskinstance.py:2327} INFO - Executing <Task(PythonOperator): start_table> on 2025-05-01 03:16:39.101064+00:00
[2025-05-01T03:21:43.483+0000] {standard_task_runner.py:63} INFO - Started process 473 to run task
[2025-05-01T03:21:43.496+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'iniciar_tabla_mysql', 'start_table', 'manual__2025-05-01T03:16:39.101064+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/mysql_start_table.py', '--cfg-path', '/tmp/tmpz8ltuyin']
[2025-05-01T03:21:43.507+0000] {standard_task_runner.py:91} INFO - Job 14: Subtask start_table
[2025-05-01T03:21:43.596+0000] {task_command.py:426} INFO - Running <TaskInstance: iniciar_tabla_mysql.start_table manual__2025-05-01T03:16:39.101064+00:00 [running]> on host 8a845f61fad8
[2025-05-01T03:21:43.766+0000] {taskinstance.py:2644} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='iniciar_tabla_mysql' AIRFLOW_CTX_TASK_ID='start_table' AIRFLOW_CTX_EXECUTION_DATE='2025-05-01T03:16:39.101064+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-01T03:16:39.101064+00:00'
[2025-05-01T03:21:43.767+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-05-01T03:21:43.809+0000] {base.py:84} INFO - Using connection ID 'mysql_***_conn' for task execution.
[2025-05-01T03:21:43.842+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-05-01T03:21:43.843+0000] {taskinstance.py:2890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 330, in _query
    db.query(q)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/connections.py", line 261, in query
    _mysql.connection.query(self, query)
MySQLdb.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'change VARCHAR(20) NOT NULL,\n            diabetesMed VARCHAR(20) NOT NULL,\n     ' at line 49")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/baseoperator.py", line 400, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/mysql_start_table.py", line 77, in start_table
    connection.execute(create_table_query)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1370, in execute
    return self._exec_driver_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1674, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 179, in execute
    res = self._query(mogrified_query)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/cursors.py", line 330, in _query
    db.query(q)
  File "/home/airflow/.local/lib/python3.8/site-packages/MySQLdb/connections.py", line 261, in query
    _mysql.connection.query(self, query)
sqlalchemy.exc.ProgrammingError: (MySQLdb.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'change VARCHAR(20) NOT NULL,\n            diabetesMed VARCHAR(20) NOT NULL,\n     ' at line 49")
[SQL: 
        CREATE TABLE IF NOT EXISTS diabetes (
            encounter_id INT NOT NULL,
            patient_nbr INT NOT NULL,
            race VARCHAR(50) NOT NULL,
            gender VARCHAR(20) NOT NULL,
            age VARCHAR(20) NOT NULL,
            weight FLOAT,
            admission_type_id INT NOT NULL,
            discharge_disposition_id INT NOT NULL,
            admission_source_id INT NOT NULL,
            time_in_hospital INT NOT NULL,
            payer_code INT,
            medical_specialty INT,
            num_lab_procedures INT NOT NULL,
            num_procedures INT NOT NULL,
            num_medications INT NOT NULL,
            number_outpatient INT NOT NULL,
            number_emergency INT NOT NULL,
            number_inpatient INT NOT NULL,
            diag_1 VARCHAR(10),
            diag_2 VARCHAR(10),
            diag_3 VARCHAR(10),
            number_diagnoses INT NOT NULL,
            max_glu_serum VARCHAR(20) NOT NULL,
            A1Cresult VARCHAR(20) NOT NULL,
            metformin VARCHAR(20) NOT NULL,
            repaglinide VARCHAR(20) NOT NULL,
            nateglinide VARCHAR(20) NOT NULL,
            chlorpropamide VARCHAR(20) NOT NULL,
            glimepiride VARCHAR(20) NOT NULL,
            acetohexamide VARCHAR(20) NOT NULL,
            glipizide VARCHAR(20) NOT NULL,
            glyburide VARCHAR(20) NOT NULL,
            tolbutamide VARCHAR(20) NOT NULL,
            pioglitazone VARCHAR(20) NOT NULL,
            rosiglitazone VARCHAR(20) NOT NULL,
            acarbose VARCHAR(20) NOT NULL,
            miglitol VARCHAR(20) NOT NULL,
            troglitazone VARCHAR(20) NOT NULL,
            tolazamide VARCHAR(20) NOT NULL,
            examide VARCHAR(20) NOT NULL,
            citoglipton VARCHAR(20) NOT NULL,
            insulin VARCHAR(20) NOT NULL,
            glyburide_metformin VARCHAR(20) NOT NULL,
            glipizide_metformin VARCHAR(20) NOT NULL,
            glimepiride_pioglitazone VARCHAR(20) NOT NULL,
            metformin_rosiglitazone VARCHAR(20) NOT NULL,
            metformin_pioglitazone VARCHAR(20) NOT NULL,
            change VARCHAR(20) NOT NULL,
            diabetesMed VARCHAR(20) NOT NULL,
            readmitted VARCHAR(20) NOT NULL
            )
            ]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-05-01T03:21:43.877+0000] {taskinstance.py:1205} INFO - Marking task as FAILED. dag_id=iniciar_tabla_mysql, task_id=start_table, execution_date=20250501T031639, start_date=20250501T032143, end_date=20250501T032143
[2025-05-01T03:21:43.901+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 14 for task start_table ((MySQLdb.ProgrammingError) (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'change VARCHAR(20) NOT NULL,\n            diabetesMed VARCHAR(20) NOT NULL,\n     ' at line 49")
[SQL: 
        CREATE TABLE IF NOT EXISTS diabetes (
            encounter_id INT NOT NULL,
            patient_nbr INT NOT NULL,
            race VARCHAR(50) NOT NULL,
            gender VARCHAR(20) NOT NULL,
            age VARCHAR(20) NOT NULL,
            weight FLOAT,
            admission_type_id INT NOT NULL,
            discharge_disposition_id INT NOT NULL,
            admission_source_id INT NOT NULL,
            time_in_hospital INT NOT NULL,
            payer_code INT,
            medical_specialty INT,
            num_lab_procedures INT NOT NULL,
            num_procedures INT NOT NULL,
            num_medications INT NOT NULL,
            number_outpatient INT NOT NULL,
            number_emergency INT NOT NULL,
            number_inpatient INT NOT NULL,
            diag_1 VARCHAR(10),
            diag_2 VARCHAR(10),
            diag_3 VARCHAR(10),
            number_diagnoses INT NOT NULL,
            max_glu_serum VARCHAR(20) NOT NULL,
            A1Cresult VARCHAR(20) NOT NULL,
            metformin VARCHAR(20) NOT NULL,
            repaglinide VARCHAR(20) NOT NULL,
            nateglinide VARCHAR(20) NOT NULL,
            chlorpropamide VARCHAR(20) NOT NULL,
            glimepiride VARCHAR(20) NOT NULL,
            acetohexamide VARCHAR(20) NOT NULL,
            glipizide VARCHAR(20) NOT NULL,
            glyburide VARCHAR(20) NOT NULL,
            tolbutamide VARCHAR(20) NOT NULL,
            pioglitazone VARCHAR(20) NOT NULL,
            rosiglitazone VARCHAR(20) NOT NULL,
            acarbose VARCHAR(20) NOT NULL,
            miglitol VARCHAR(20) NOT NULL,
            troglitazone VARCHAR(20) NOT NULL,
            tolazamide VARCHAR(20) NOT NULL,
            examide VARCHAR(20) NOT NULL,
            citoglipton VARCHAR(20) NOT NULL,
            insulin VARCHAR(20) NOT NULL,
            glyburide_metformin VARCHAR(20) NOT NULL,
            glipizide_metformin VARCHAR(20) NOT NULL,
            glimepiride_pioglitazone VARCHAR(20) NOT NULL,
            metformin_rosiglitazone VARCHAR(20) NOT NULL,
            metformin_pioglitazone VARCHAR(20) NOT NULL,
            change VARCHAR(20) NOT NULL,
            diabetesMed VARCHAR(20) NOT NULL,
            readmitted VARCHAR(20) NOT NULL
            )
            ]
(Background on this error at: https://sqlalche.me/e/14/f405); 473)
[2025-05-01T03:21:43.948+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-05-01T03:21:43.979+0000] {taskinstance.py:3482} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-05-01T03:21:43.981+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
